##########################        SPIN CONFIG        ##########################

#### Dataset params ###########################################################
dataset_name: lane
val_len: 0.1

window: 10
stride: 1

# 多组数据配置
# 每个mask字段可以是单个文件路径，也可以是文件路径列表
# 如果是列表，训练时每个epoch会按顺序循环选择mask文件（epoch % len(mask_files)）
# 这样可以避免固定缺失模式形成硬编码式捷径，同时确保每个mask文件被均匀使用
data_groups:
  - static: ./data/graph_40m.json
    dynamic: ./data/d210240830_lane_node_stats.csv
    mask: 
      - ./data/d210240830_lane_mask.csv
      - ./data/d210240830_lane_mask_2.csv
      - ./data/d210240830_lane_mask_3.csv
      - ./data/d210240830_lane_mask_4.csv
  - static: ./data/graph_40m.json
    dynamic: ./data/d210240900_lane_node_stats.csv
    mask:
      - ./data/d210240900_lane_mask.csv
      - ./data/d210240900_lane_mask_2.csv
      - ./data/d210240900_lane_mask_3.csv
      - ./data/d210240900_lane_mask_4.csv
  - static: ./data/graph_40m.json
    dynamic: ./data/d210240930_lane_node_stats.csv
    mask:
      - ./data/d210240930_lane_mask.csv
      - ./data/d210240930_lane_mask_2.csv
      - ./data/d210240930_lane_mask_3.csv
      - ./data/d210240930_lane_mask_4.csv

#### Training params ##########################################################
whiten_prob: [0.0, 0.0, 0.0]
scale_target: True

epochs: 30  # 最大训练轮数。如果知道想要在哪个epoch停止，直接设置为此值即可
loss_fn: l1_loss
lr_scheduler: magic
lr: 0.0008
patience: 5  # 早停耐心值：验证集MAE连续N个epoch没有改善就停止
min_delta: 0.001  # 早停的最小改善阈值，验证集MAE需要改善至少这个值才不算"没有改善"。设置为0则任何改善都算
l2_reg: 0.0001  # L2正则化，防止过拟合。如果过拟合严重，可以增加到0.001
precision: 32
batch_size: 4
split_batch_in: 2
batches_epoch: 300
gradient_checkpointing: True

#### Model params #############################################################
model_name: 'spin'
hidden_size: 8
eta: 2
n_layers: 2
message_layers: 2
temporal_self_attention: True
reweight: 'softmax'
max_temporal_distance: 5  # 时间步最大连接距离，None 表示全连接
