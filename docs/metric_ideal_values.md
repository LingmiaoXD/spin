# 训练指标理想值参考指南

## 📊 指标说明

训练最后打印的指标都是针对**缺失值**计算的（masked metrics），且数据经过**标准化**处理（均值为0，标准差为1）。

### 指标含义

- **test_loss**: 测试集上的损失值（默认使用L1 loss，即MAE）
- **val_mae**: 验证集上的平均绝对误差（Mean Absolute Error）
- **val_mre**: 验证集上的平均相对误差（Mean Relative Error）
- **val_mse**: 验证集上的均方误差（Mean Squared Error）

## 🎯 理想值范围

### 对于标准化后的数据（均值为0，标准差为1）

| 指标 | 优秀值 | 良好值 | 可接受值 | 需要改进 |
|------|--------|--------|----------|----------|
| **test_loss** | < 0.05 | < 0.1 | < 0.2 | ≥ 0.2 |
| **val_mae** | < 0.05 | < 0.1 | < 0.2 | ≥ 0.2 |
| **val_mse** | < 0.005 | < 0.01 | < 0.05 | ≥ 0.05 |
| **val_mre** | < 0.05 (5%) | < 0.1 (10%) | < 0.2 (20%) | ≥ 0.2 (20%) |

### 详细说明

#### 1. **test_loss** 和 **val_mae**
- **理想值**: < 0.1
- **优秀值**: < 0.05
- **说明**: 
  - 由于数据已标准化，MAE < 0.1 表示平均预测误差小于标准差的10%
  - 根据代码中的判断逻辑（`analyze_training_curves.py`），MAE > 0.5 被认为是欠拟合
  - 如果 MAE < 0.05，说明模型预测非常准确

#### 2. **val_mse**
- **理想值**: < 0.01
- **优秀值**: < 0.005
- **说明**: 
  - MSE是平方误差，所以数值会比MAE更小
  - MSE < 0.01 表示平均平方误差小于标准差的1%
  - 由于是平方，MSE对异常值更敏感

#### 3. **val_mre**
- **理想值**: < 0.1 (10%)
- **优秀值**: < 0.05 (5%)
- **说明**: 
  - MRE是相对误差，表示预测误差相对于真实值的比例
  - MRE < 0.1 表示平均相对误差小于10%
  - 这是最直观的指标，表示预测误差的百分比

## 📈 判断模型状态

### 良好拟合（Good Fit）
- **val_mae** < 0.1
- **val_mae** 和 **train_mae** 的差距（gap）< 5%
- **val_mre** < 0.1

### 欠拟合（Underfitting）
- **val_mae** > 0.5
- **val_mae** 和 **train_mae** 的差距很小（< 5%）
- **建议**: 增加模型容量（hidden_size, n_layers）、增加训练轮数、提高学习率

### 过拟合（Overfitting）
- **val_mae** 和 **train_mae** 的差距 > 30%
- **建议**: 增加正则化（l2_reg）、增加dropout、减少模型容量、增加数据增强

## 🔍 实际示例

### 优秀训练结果示例
```
test_loss: 0.042
val_mae: 0.038
val_mse: 0.003
val_mre: 0.045 (4.5%)
```
✅ 所有指标都在优秀范围内

### 良好训练结果示例
```
test_loss: 0.085
val_mae: 0.092
val_mse: 0.012
val_mre: 0.088 (8.8%)
```
✅ 所有指标都在良好范围内

### 需要改进的示例
```
test_loss: 0.35
val_mae: 0.42
val_mse: 0.28
val_mre: 0.38 (38%)
```
⚠️ 所有指标都偏高，需要检查模型配置和训练策略

## 💡 注意事项

1. **数据标准化影响**: 由于数据经过标准化，这些指标值会相对较小。如果数据未标准化，指标值会大得多。

2. **缺失值比例**: 缺失值比例越高，插补难度越大，指标值可能相对较高。

3. **数据集特性**: 不同数据集的复杂度不同，理想值可能有所差异。建议：
   - 先运行baseline（如均值填充）作为参考
   - 观察训练曲线，确保模型在持续改善
   - 对比不同模型的结果

4. **相对比较**: 更重要的是观察指标的变化趋势：
   - 训练过程中指标是否持续下降
   - 验证集和训练集的指标差距是否合理
   - 不同超参数配置下的对比

## 🎓 参考基准

根据代码中的判断逻辑（`experiments/analyze_training_curves.py`）：
- **MAE > 0.5**: 被认为是欠拟合
- **MAE < 0.1 且 gap < 5%**: 被认为是良好拟合
- **gap > 30%**: 被认为是过拟合

因此，**val_mae < 0.1** 是一个很好的目标值。


